import '../matchers';
import { exampleSongSymbol } from '../fixtures/song';
import PdfFormatter from '../../src/formatter/pdf_formatter';
import defaultConfiguration from '../../src/formatter/pdf_formatter/default_configuration';
import StubbedPdfDoc from './stubbed_pdf_doc';

describe('PdfFormatter', () => {
  it('correctly formats a basic song', () => {
    const formatter = new PdfFormatter();
    formatter.format(exampleSongSymbol, defaultConfiguration, StubbedPdfDoc);
    const doc = formatter.doc as StubbedPdfDoc;

    expect(doc).toHaveText('Let it be', 45, 50);
    expect(doc).toHaveText('Key of C - BPM  - Time', 45, 63);
    expect(doc).toHaveText('By  ChordSheetJS example version', 45, 73);
    expect(doc).toHaveText('Â©2024 My Music Publishing', 45, 752);
    expect(doc).toHaveText('Written by: ', 45, 95);
    expect(doc).toHaveText('Verse 1', 45, 119);
    expect(doc).toHaveText('Let it ', 45, 144);
    expect(doc).toHaveText('Am', 69, 133);
    expect(doc).toHaveText('be,', 69, 144);
    expect(doc).toHaveText('let it ', 88, 144);
    expect(doc).toHaveText('C/G  ', 108, 133);
    expect(doc).toHaveText('be,', 108, 144);
    expect(doc).toHaveText('let it ', 131, 144);
    expect(doc).toHaveText('F', 152, 133);
    expect(doc).toHaveText('be,', 152, 144);
    expect(doc).toHaveText('let it ', 166, 144);
    expect(doc).toHaveText('C', 187, 133);
    expect(doc).toHaveText('be', 187, 144);
    expect(doc).toHaveText('C', 45, 158);
    expect(doc).toHaveText('Whisper ', 45, 169);
    expect(doc).toHaveText('words of ', 81, 169);
    expect(doc).toHaveText('F', 119, 158);
    expect(doc).toHaveText('wis', 119, 169);
    expect(doc).toHaveText('G', 133, 158);
    expect(doc).toHaveText('dom,', 133, 169);
    expect(doc).toHaveText('let it ', 156, 169);
    expect(doc).toHaveText('F', 176, 158);
    expect(doc).toHaveText('be ', 176, 169);
    expect(doc).toHaveText('C/E  ', 188, 158);
    expect(doc).toHaveText('Dm  ', 208, 158);
    expect(doc).toHaveText('C', 226, 158);
    expect(doc).toHaveText('Breakdown', 45, 193);
    expect(doc).toHaveText('Am', 45, 207);
    expect(doc).toHaveText('Whisper words of ', 45, 218);
    expect(doc).toHaveText('Bb', 119, 207);
    expect(doc).toHaveText('wisdom,', 119, 218);
    expect(doc).toHaveText('let it ', 156, 218);
    expect(doc).toHaveText('F', 176, 207);
    expect(doc).toHaveText('be ', 176, 218);
    expect(doc).toHaveText('C', 188, 207);
    expect(doc).toHaveText('Tab 1', 45, 242);
    expect(doc).toHaveText('ABC 1', 45, 274);
    expect(doc).toHaveText('LY 1', 45, 306);
    expect(doc).toHaveText('Bridge 1', 45, 338);
    expect(doc).toHaveText('Bridge line', 45, 352);
    expect(doc).toHaveText('Grid 1', 45, 376);
  });
});
